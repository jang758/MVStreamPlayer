# MVStreamPlayer 🎬

yt-dlp 기반 스트리밍 비디오 플레이어입니다. MissAV 계열 사이트의 Cloudflare 우회 및 P.A.C.K.E.R. 난독화 해제를 지원합니다.

## 시작하기

### 1. 실행

```bat
start.bat 더블클릭
```

또는 수동 실행:

```bash
pip install -r requirements.txt
python server.py
```

### 2. 브라우저에서 접속

```
http://localhost:5000
```

---

## 기능

### 📋 대기열 관리

| 기능 | 설명 |
|------|------|
| **URL 추가** | URL 입력란에 주소 붙여넣고 `추가` 버튼 클릭 |
| **강제 추가** | 중복이어도 강제로 대기열에 추가 (추가 버튼 우측 `강제` 버튼) |
| **새로고침** | 대기열 목록 새로고침 버튼으로 최신 상태 반영 |
| **삭제** | 각 항목 우측 삭제 버튼 또는 다중 선택 후 일괄 삭제 |
| **순서 변경** | 이동 버튼(↑↓)으로 순서 조정, 맨 위/맨 아래 이동 지원 |
| **대기열 비우기** | 전체 비우기 버튼으로 대기열 초기화 |
| **가져오기/내보내기** | 대기열을 JSON 파일로 내보내거나 불러오기 |

### 🔍 검색 및 추가

| 기능 | 설명 |
|------|------|
| **검색창 열기** | 🔍 버튼 클릭 → 별도 팝업 검색 창 열림 |
| **검색 결과 추가** | 검색 결과에서 원하는 영상 직접 대기열에 추가 |

### 📂 카테고리

| 기능 | 설명 |
|------|------|
| **카테고리 생성** | 이름과 색상을 지정해 카테고리 추가 |
| **카테고리 탭** | 탭 클릭으로 카테고리별 필터링 |
| **항목 분류** | 우클릭 컨텍스트 메뉴 또는 다중 선택으로 카테고리 일괄 지정 |

### �️ 우클릭 컨텍스트 메뉴

대기열 항목을 우클릭하면:
- **재생** — 바로 재생
- **다운로드** — 다운로드 대기열에 추가
- **사이트 열기** — 원본 사이트 새 창으로 열기
- **삭제** — 대기열에서 제거

### ⬇️ 다운로드 매니저

| 기능 | 설명 |
|------|------|
| **동시 다운로드** | 기본 2개 동시, 설정에서 1~5개 조정 가능 |
| **진행률 표시** | 각 항목 속도, ETA, 크기 실시간 표시 |
| **취소/삭제** | 개별 취소 및 완료 항목 삭제 |
| **완료 항목 지우기** | "완료 지우기" 버튼으로 일괄 정리 |

### 🎮 플레이어

| 기능 | 설명 |
|------|------|
| **재생 위치 기억** | 영상 종료 시 위치 자동 저장, 재실행 시 복원 |
| **반복 히트맵** | 자주 본 구간이 진행바에 열지도 형태로 표시 |
| **재생 속도 조절** | 0.25x ~ 4x 배속 선택 |
| **볼륨 조절** | 슬라이더 또는 스크롤 휠로 조절 |
| **항상 위 (Always on Top)** | 핀 버튼으로 창 최상위 고정 |

---

## 키보드 단축키

| 키 | 동작 |
|----|------|
| `Space` | 재생/정지 |
| `←` | 10초 뒤로 |
| `→` | 10초 앞으로 |
| `Shift+←` | 5초 뒤로 |
| `Shift+→` | 5초 앞으로 |
| `↑ / ↓` | 음량 +5% / -5% |
| `M` | 음소거 토글 |
| `F` | 전체화면 |
| `Shift+N` | 다음 영상 |
| `Shift+P` | 이전 영상 |
| `, / .` | 프레임 단위 이동 (일시정지 중) |

---

## 쿠키 설정 (선택)

인증이 필요한 사이트의 경우:

1. `cookies.txt` 파일(Netscape 포맷)을 앱 폴더에 넣기
   - Chrome 확장 **"Get cookies.txt LOCALLY"** 등으로 추출 가능
2. 쿠키가 감지되면 상단에 `🍪 쿠키 적용됨` 표시

---

## 지원 사이트

- **범용**: yt-dlp가 지원하는 모든 사이트 (YouTube 등)
- **MissAV 계열**: `missav.ws`, `missav.ai`, `missav.com`, `njavtv.com`
  - Cloudflare 우회 + P.A.C.K.E.R. 난독화 해제 + HLS 세그먼트 프록시 내장

---

## 폴더 구조

```
MVStreamPlayer/
├── server.py          # 백엔드 서버
├── hitomi.py          # MissAV 추출 참조 로직
├── app.py             # 앱 진입점
├── static/
│   ├── app.js         # 프론트엔드 로직
│   ├── style.css      # 다크 테마 스타일
│   ├── search.js      # 검색 창 로직
│   └── search.css     # 검색 창 스타일
├── templates/
│   ├── index.html     # 메인 페이지
│   └── search.html    # 검색 페이지
├── cookies.txt        # (직접 넣기) Netscape 형식 쿠키
├── downloads/         # 다운로드된 영상 저장 위치
├── requirements.txt
├── start.bat
└── README.md
```
